# ==============================================================================
# PREFIX KEY CONFIGURATION
# ==============================================================================

# Unbind the default prefix (Ctrl-b)
unbind C-b
# Set the prefix key to Alt-b (Option-b on Mac)
set -g prefix M-b
# Allow sending the prefix through to nested tmux sessions
bind M-b send-prefix

# ==============================================================================
# GENERAL SETTINGS
# ==============================================================================

# Disable visual bell to prevent status bar notifications that slow down tab completion
set -g visual-bell off
# Disable bell actions to prevent interruptions
set -g bell-action none

# Use vi-style keys in copy mode
setw -g mode-keys vi

# Sync tmux clipboard with the system clipboard
set -g set-clipboard on

# Enable mouse support for pane selection and resizing
set -g mouse on

# ==============================================================================
# KEY BINDINGS
# ==============================================================================

# --- Pane Navigation ---
# Use Vim-style keys (h/j/k/l) for pane navigation
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# --- Pane/Window Creation ---
# Open splits and new windows in the current pane's directory
bind % split-window -h -c "#{pane_current_path}"
bind '"' split-window -v -c "#{pane_current_path}"
bind c new-window -c "#{pane_current_path}"

# --- Session Management ---
# Create a new session and switch to it (prefix + Shift-S)
bind S command-prompt -p "New session name:" "new-session -d -s '%%'; switch-client -t '%%'"

# --- Config Reload ---
# Reload tmux config and show a confirmation message (prefix + r)
bind r source-file ~/.tmux.conf \; display-message "tmux reloaded"

# ==============================================================================
# STATUS BAR STYLING
# ==============================================================================

# Position status bar at bottom and left-justify window list
set -g status-position bottom
set -g status-justify left

# Status bar colors
set -g status-style 'bg=#006562 fg=#e6f8f8'

# Left side of status bar (empty)
set -g status-left ''

# Right side of status bar: git branch, time, and date
set -g status-right '#[fg=#002221,bg=#006562] %H:%M #[fg=#002221,bg=#006562]  %Y-%m-%d '
set -g status-right-length 100

# Window status styling with powerline-style arrows
# Active window
set -g window-status-current-format '#[fg=#002221,bg=#1ab2ad]#[fg=#002221,bg=#1ab2ad] #I #W #[fg=#1ab2ad,bg=#002221]'
# Inactive windows
set -g window-status-format '#[fg=#002221,bg=#006562]#[fg=#99dddb,bg=#006562] #I #W #[fg=#006562,bg=#002221]'
# No separator between windows (using arrows instead)
set -g window-status-separator ''

# ==============================================================================
# PLUGINS
# ==============================================================================

# Tmux Plugin Manager (TPM)
set -g @plugin 'tmux-plugins/tpm'
# Sensible default settings
set -g @plugin 'tmux-plugins/tmux-sensible'
# Save and restore tmux sessions across reboots
set -g @plugin 'tmux-plugins/tmux-resurrect'
# Automatic continuous session saving
set -g @plugin 'tmux-plugins/tmux-continuum'

# Enable automatic session restore on tmux start
set -g @continuum-restore 'on'

# ==============================================================================
# INITIALIZE TPM (must be at the very end of the file)
# ==============================================================================
run '~/.config/tmux/plugins/tpm/tpm'
